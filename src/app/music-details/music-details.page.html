<ion-header [translucent]="true">
  <ion-toolbar class="stunning-header">
    <ion-buttons slot="start">
      <ion-menu-button></ion-menu-button>
    </ion-buttons>
    <ion-title class="header-title">
      <ion-icon name="musical-notes" class="title-icon"></ion-icon>
      {{topics.title}}
    </ion-title>
    <ion-buttons slot="end">
      <ion-button fill="clear" class="action-btn">
        <ion-icon name="heart-outline"></ion-icon>
      </ion-button>
      <ion-button fill="clear" class="action-btn">
        <ion-icon name="share-outline"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true" class="music-details-page">
  <!-- Loading State -->
  <div *ngIf="isLoading" class="loading-container">
    <div class="loading-content">
      <ion-spinner name="circular" class="loading-spinner"></ion-spinner>
      <p class="loading-text">Loading {{topics.title}}...</p>
    </div>
  </div>

  <!-- Content Container -->
  <div *ngIf="!isLoading" class="content-container">
    <!-- Hero Section -->
    <div class="hero-section">
      <div class="hero-content">
        <h1 class="hero-title">{{topics.title}}</h1>
        <p class="hero-subtitle">{{topics.content}}</p>
      </div>
      <div class="hero-graphic">
        <ion-icon name="musical-notes" class="floating-note note-1"></ion-icon>
        <ion-icon name="musical-note" class="floating-note note-2"></ion-icon>
        <ion-icon name="musical-notes" class="floating-note note-3"></ion-icon>
      </div>
    </div>

    <!-- Audio Player Component (Hidden by default) -->
    <div *ngIf="selectedAudio" class="audio-player-section">
      <div class="audio-player-header">
        <ion-button 
          fill="clear" 
          size="small" 
          class="back-to-cards-btn"
          (click)="backToCards()">
          <ion-icon name="arrow-back" slot="start"></ion-icon>
          Back to {{getContentTypeName()}}
        </ion-button>
      </div>
      
      <app-ionic-audio-player 
        [audioData]="selectedAudio"
        (onClose)="closeAudioPlayer()">
      </app-ionic-audio-player>
    </div>

    <!-- Content Sections (Hidden when audio player is open) -->
    <div *ngIf="!selectedAudio" class="content-sections">

    <!-- Important Slokas Section -->
    <div *ngIf="language === 'sloka 35'" class="categories-container">
      <div class="category-header">
        <h2 class="category-title">
          <ion-icon name="star" class="category-icon"></ion-icon>
          Important Slokas Collection
        </h2>
        <ion-button fill="clear" size="small" class="view-all-btn">
          <span>{{msDatas.length}} Slokas</span>
        </ion-button>
      </div>

      <div class="cards-grid">
        <div class="content-card audio-card" 
             *ngFor="let sloka of msDatas; let i = index" 
             (click)="playSloka(sloka)"
             [style.animation-delay]="(i * 0.1) + 's'">
          
          <!-- Card Background -->
          <div class="card-background"></div>
          
          <!-- Audio Icon -->
          <div class="audio-icon-container">
            <div class="audio-icon-wrapper">
              <ion-icon name="volume-high" class="audio-icon"></ion-icon>
            </div>
            <div class="sound-waves">
              <div class="wave wave-1"></div>
              <div class="wave wave-2"></div>
              <div class="wave wave-3"></div>
            </div>
          </div>

          <!-- Card Content -->
          <div class="card-content">
            <div class="card-brand">Sloka {{sloka.orderNo}}</div>
            <h3 class="card-title">{{sloka.slokaNo}}</h3>
            
            <!-- Play Button -->
            <div class="play-button-container">
              <div class="play-button">
                <ion-icon name="play" class="play-icon"></ion-icon>
              </div>
              <span class="play-text">Listen</span>
            </div>
          </div>

          <!-- Hover Effects -->
          <div class="hover-overlay">
            <div class="ripple-effect"></div>
          </div>
        </div>
      </div>
    </div>

    <!-- Tamil Chapters Section -->
    <div *ngIf="language === 'Tamil'" class="categories-container">
      <div class="category-header">
        <h2 class="category-title">
          <ion-icon name="library" class="category-icon"></ion-icon>
          {{groupedChapters.length > 0 ? groupedChapters[0].languageType : 'Tamil'}} Chapters
        </h2>
        <ion-button fill="clear" size="small" class="view-all-btn">
          <span>{{tamilChapters.length}} Chapters</span>
        </ion-button>
      </div>

      <div class="cards-grid">
        <div class="content-card chapter-card" 
             *ngFor="let chapter of tamilChapters; let i = index" 
             (click)="playChapter(chapter)"
             [style.animation-delay]="(i * 0.1) + 's'">
          
          <!-- Card Background -->
          <div class="card-background"></div>
          
          <!-- Chapter Number Badge -->
          <div class="chapter-number">
            {{getChapterNumber(chapter.chapterNo)}}
          </div>
          
          <!-- Audio Icon -->
          <div class="audio-icon-container">
            <div class="audio-icon-wrapper">
              <ion-icon name="book" class="audio-icon"></ion-icon>
            </div>
          </div>

          <!-- Card Content -->
          <div class="card-content">
            <div class="card-brand">{{chapter.chapterNo}}</div>
            <h3 class="card-title">{{chapter.chapterName}}</h3>
            
            <!-- Play Button -->
            <div class="play-button-container">
              <div class="play-button">
                <ion-icon name="play" class="play-icon"></ion-icon>
              </div>
              <span class="play-text">Listen</span>
            </div>
          </div>

          <!-- Hover Effects -->
          <div class="hover-overlay">
            <div class="ripple-effect"></div>
          </div>
        </div>
      </div>
    </div>

    <!-- Other Languages Placeholder -->
    <div *ngIf="language === 'English' || language === 'Hindi' || language === 'Kannada'" class="categories-container">
      <div class="category-header">
        <h2 class="category-title">
          <ion-icon name="globe" class="category-icon"></ion-icon>
          {{language}} Content
        </h2>
      </div>

      <div class="coming-soon-card">
        <div class="coming-soon-content">
          <ion-icon name="construct" class="coming-soon-icon"></ion-icon>
          <h3>Coming Soon</h3>
          <p>{{language}} content will be available soon. Stay tuned!</p>
        </div>
      </div>
    </div>

    <!-- Stats Section -->
    <div class="stats-section">
      <div class="stat-card">
        <div class="stat-number">{{getTotalContent()}}</div>
        <div class="stat-label">Total Content</div>
      </div>
      <div class="stat-card">
        <div class="stat-number">{{language}}</div>
        <div class="stat-label">Language</div>
      </div>
      <div class="stat-card">
        <div class="stat-number">HD</div>
        <div class="stat-label">Audio Quality</div>
      </div>
    </div>
    </div> <!-- End of content-sections -->

  </div>
</ion-content>
