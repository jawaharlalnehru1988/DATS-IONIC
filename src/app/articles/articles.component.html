
<app-reusable-header 
  [title]="'Articles & Blogs'" 
  [translucent]="true" 
  [showMenuButton]="true">
</app-reusable-header>

<ion-content>
  <!-- Temporary Debug Component -->
  <!-- <app-auth-debug></app-auth-debug> -->

  <!-- Add Blog Button - Only visible for admin users -->
  <div class="add-blog-section" *appShowForRoles="['admin']">
    <ion-button (click)="openAddBlogForm()" fill="solid" expand="block" class="add-blog-btn">
      <ion-icon name="add" slot="start"></ion-icon>
      Add New Blog
    </ion-button>
  </div>

<ion-segment value="english" (ionChange)="onLanguageChange($event)" class="language-segment">
  <ion-segment-button value="english">
    <ion-label>English</ion-label>
  </ion-segment-button>
  <ion-segment-button value="tamil">
    <ion-label>Tamil</ion-label>
  </ion-segment-button>
  <ion-segment-button value="hindi">
    <ion-label>Hindi</ion-label>
  </ion-segment-button>
  <ion-segment-button value="kannada">
    <ion-label>Kannada</ion-label>
  </ion-segment-button>
  <ion-segment-button value="telugu">
    <ion-label>Telugu</ion-label>
  </ion-segment-button>
</ion-segment>

<ion-content class="articles-content">
  <div class="articles-container">
    <!-- English Content - Simple Blog List -->
    <div *ngIf="isEnglishSelected()" class="english-content">
      <div class="blogs-grid">
        <div class="blog-card" 
             *ngFor="let blog of blogs" 
             (click)="onCardClick(blog._id!)">
          <div class="card-actions" *appShowForRoles="['admin']">
            <ion-button 
              fill="clear" 
              size="small" 
              (click)="editBlog(blog._id!, $event)"
              class="edit-btn">
              <ion-icon name="create-outline"></ion-icon>
            </ion-button>
            <ion-button 
              fill="clear" 
              size="small" 
              (click)="confirmDeleteBlog(blog._id!, $event)"
              class="delete-btn">
              <ion-icon name="trash-outline"></ion-icon>
            </ion-button>
          </div>
          <img [src]="blog.blogImgUrl" [alt]="blog.blogTitle">
          <div class="card-content">
            <h3>{{ blog.blogTitle }}</h3>
            <p class="author">By {{ blog.author }}</p>


            <!-- <p class="content-preview">{{ blog.content | slice:0:100 }}{{ blog.content.length > 100 ? '...' : '' }}</p> -->
            <div class="comments-count" *ngIf="blog.comments && blog.comments.length > 0">
              <ion-icon name="chatbubble-outline"></ion-icon>
              <span>{{ blog.comments.length }} comment{{ blog.comments.length !== 1 ? 's' : '' }}</span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Other Languages - Coming Soon Message -->
    <div *ngIf="!isEnglishSelected()" class="coming-soon-content">
      <div class="coming-soon-card">
        <ion-icon name="language-outline" class="coming-soon-icon"></ion-icon>
        <h2>Articles Yet to be Added</h2>
        <p>We are working on bringing you amazing content in {{ selectedLanguage === 'tamil' ? 'Tamil' : selectedLanguage === 'hindi' ? 'Hindi' : selectedLanguage === 'kannada' ? 'Kannada' : 'Telugu' }}.</p>
        <p class="subtitle">Please check back soon!</p>
      </div>
    </div>
  </div>
</ion-content>

<!-- Blog Form Modal -->
<app-blog-form
  [isOpen]="isFormOpen"
  [editingBlog]="editingBlog"
  (modalClosed)="closeBlogForm()"
  (blogSaved)="onBlogSaved($event)">
</app-blog-form>

<!-- Action Sheet for Blog Actions -->
<ion-action-sheet
  [isOpen]="isActionSheetOpen"
  header="Blog Actions"
  (didDismiss)="closeActionSheet()"
  [buttons]="actionSheetButtons">
</ion-action-sheet>